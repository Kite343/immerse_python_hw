# üìå –ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –∏ –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥
# –ø—É—Ç—å –¥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –Ω–∞ –ü–ö.
# üìå –°–æ–±–µ—Ä–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º –≤ –≤–∏–¥–µ –æ–±—ä–µ–∫—Ç–æ–≤ namedtuple.
# üìå –ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç —Ö—Ä–∞–Ω–∏—Ç:
# ‚óã –∏–º—è —Ñ–∞–π–ª–∞ –±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∞,
# ‚óã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ, –µ—Å–ª–∏ —ç—Ç–æ —Ñ–∞–π–ª,
# ‚óã —Ñ–ª–∞–≥ –∫–∞—Ç–∞–ª–æ–≥–∞,
# ‚óã –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞.
# üìå –í –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–±–æ—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –∏—Å–ø–æ–ª—å–∑—É—è
# –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ.

# –∑–∞ –æ—Å–Ω–æ–≤—É –≤–∑—è—Ç–æ –¥–∑ –∏–∑ HW_8

__all__ = ["dir_info"]

from collections import namedtuple
import logging
import os
import argparse

# –∏–ª–∏ –ª—É—á—à–µ filemode='a'?
FORMAT = '{levelname:<8} - {asctime}. {msg}'
logging.basicConfig(filename='log_dir_1.log', format=FORMAT, style='{', filemode='w', encoding='utf-8', level=logging.INFO)
logger = logging.getLogger(__name__)

def dir_info(dir_):
    Object_in_dir = namedtuple('Object_in_dir', ['name', 'ext_or_folder','size', 'parent_folder'])

    # –∏–¥–µ–º —Å –∫–æ–Ω—Ü–∞ –≤ –Ω–∞—á–∞–ª–æ, –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –ø–æ–¥—Å—á–µ—Ç–∞ —Ä–∞–∑–º–µ—Ä–∞ –ø–∞–ø–æ–∫
    # 0 –ø–æ–∑–∏—Ü–∏—è - —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –ø–∞–ø–∫–∞
    # 1 –ø–æ–∑–∏—Ü–∏—è - —Å–ø–∏—Å–æ–∫ –ø–∞–ø–æ–∫ –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –ø–∞–ø–∫–µ
    # 2 –ø–æ–∑–∏—Ü–∏—è - —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ –ø–∞–ø–∫–µ
    size_folders = {}  # –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —Ä–∞–∑–º–µ—Ä–∞ –ø–∞–ø–æ–∫
    for folder in os.walk(dir_, topdown=False):
        # –∏–º—è —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –ø–∞–ø–∫–∏
        parent_fold = folder[0].rsplit("\\", 1)[-1]
        sum = 0

        # –ø—Ä–æ—Ö–æ–¥–∏–º—Å—è –ø–æ —Ñ–∞–π–ª–∞–º –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –∏—Ö –¥–∞–Ω–Ω—ã–µ
        # —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –¥–æ–±–∞–≤–ª—è–µ–º –≤ —Å—É–º–º—É –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –ø–∞–ø–∫–∏
        # —É —Ñ–∞–π–ª–æ–≤ –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∏–º—è —Ä–∞–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –ø–∞–ø–∫–∏
        # –∞ –Ω–µ –≤–µ—Å—å –ø—É—Ç—å, —Ç.–∫. –±–æ–ª—å—à–µ –º—ã –∫ –Ω–∏–º –æ–±—Ä–∞—â–∞—Ç—å—Å—è –Ω–µ –±—É–¥–µ–º
        for file in folder[2]:
            size = os.path.getsize(f'{folder[0]}\\{file}')
            sum += size
            new_ob =  Object_in_dir(file.rsplit(".", 1)[0], 
                                    file.rsplit(".", 1)[-1], size, parent_fold)
            logger.info(f'Data: {new_ob}')
            
        # –ø—Ä–æ—Ö–æ–¥–∏–º—Å—è –ø–æ –¥–æ—á–µ—Ä–Ω–∏–º –ø–∞–ø–∫–∞–º
        # –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∏—Ö —Ä–∞–∑–º–µ—Ä –≤ —Å—É–º–º—É –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –ø–∞–ø–∫–∏
        # –∑–Ω–∞—á–µ–Ω–∏—è –±–µ—Ä–µ–º –∏–∑ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è
        # 1 –ø–æ–∑–∏—Ü–∏—è - —Å–ø–∏—Å–æ–∫ –ø–∞–ø–æ–∫ –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –ø–∞–ø–∫–µ –ø—Ä–æ—Ö–æ–¥–∏–º—Å—è –ø–æ –Ω–µ–π
        for fold in folder[1]:
            sum += size_folders[os.path.join(folder[0] ,fold)]

        # –¥–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ª–æ–≤–∞—Ä—å —Ä–∞–∑–º–µ—Ä –ø–∞–ø–∫–∏
        size_folders[folder[0]] = sum

        # –¥–æ–±–∞–≤–ª—è–µ–º —Å–∞–º—É —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é –ø–∞–ø–∫—É –∫–∞–∫ –æ–±—ä–µ–∫—Ç
        parent = folder[0].rsplit("\\", 2)
        parent = None if len(parent) == 1 else parent[-2]
        new_ob = Object_in_dir(folder[0].rsplit("\\", 1)[-1], 'folder', sum, parent)
        logger.info(f'Data: {new_ob}')
    
def parser():
    parser = argparse.ArgumentParser(description='Folder parser info')
    parser.add_argument('-f', metavar='folder', default=os.getcwd(), help="folder")
    args = parser.parse_args()
    print(args)
    dir_info(args.f)
    

if __name__ == '__main__':
    parser()

# python HW_15\\hw_task_var_2.py -f "–ø—É—Ç—å –∫ –ø–∞–ø–∫–µ"
#  –∏–ª–∏
# python HW_15\\hw_task_var_2.py


# –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∏ –≥–ª—É–±–∏–Ω–µ –ø–∞–ø–æ–∫, —Ç–∞–∫–æ–π –∫–æ–¥ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±—ã—Å—Ç—Ä–µ–µ,
# —á–µ–º –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞–ø–∫–∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç—Å—è –æ–ø—è—Ç—å –ø–æ –≤—Å–µ–º –ø–∞–ø–∫–∞–º –∏ —Ñ–∞–π–ª–∞–º, –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —Ä–∞–∑–º–µ—Ä–∞ –ø–∞–ø–∫–∏
# –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–ª—è —ç—Ç–æ–≥–æ —É–∂–µ —Ä–∞–Ω–µ–µ –ø–æ–ª—É—á–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é